.. role:: raw-html(raw)
   :format: html

.. role:: underline
   :class: underline

.. role:: bold-italic
   :class: bold-italic

==========
Projectile
==========

.. _EEex_Projectile_CastUserType:

:underline:`EEex_Projectile_CastUserType`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Aliases:** ``EEex_Projectile_CastUT``

.. note::
   **Summary:** Takes the given ``projectile`` and returns a cast userdata that represents ``projectile``'s true type.
   
   Most EEex functions will call this function before passing a projectile to the modder API.

**Parameters:**

+------------+-------------+-------------------+-------------------------+
| **Name**   | **Type**    | **Default Value** | **Description**         |
+------------+-------------+-------------------+-------------------------+
| projectile | CProjectile |                   | The projectile to cast. |
+------------+-------------+-------------------+-------------------------+

**Return Values:**

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+
| **Type**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | **Description** |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+
| :raw-html:`<pre>` CProjectile                    | CProjectileAmbiant             | CProjectileArea                | :raw-html:`<br/>` CProjectileBAM                 | CProjectileCallLightning       | CProjectileCastingGlow         | :raw-html:`<br/>` CProjectileChain               | CProjectileColorSpray          | CProjectileConeOfCold          | :raw-html:`<br/>` CProjectileFall                | CProjectileFireHands           | CProjectileInstant             | :raw-html:`<br/>` CProjectileInvisibleTravelling | CProjectileLightningBolt       | CProjectileLightningBoltGround | :raw-html:`<br/>` CProjectileLightningBounce     | CProjectileLightningStorm      | CProjectileMagicMissileMulti   | :raw-html:`<br/>` CProjectileMulti               | CProjectileMushroom            | CProjectileNewScorcher         | :raw-html:`<br/>` CProjectileScorcher            | CProjectileSegment             | CProjectileSkyStrike           | :raw-html:`<br/>` CProjectileSkyStrikeBAM        | CProjectileSpellHit            | CProjectileTravelDoor          | nil :raw-html:`</pre>` | See summary.    |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+


==========================================================================================================================================================================================================

.. _EEex_Projectile_GetType:

:underline:`EEex_Projectile_GetType`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Instance Name:** ``getType``

.. note::
   **Summary:** Returns the ``EEex_Projectile_Type`` of the given ``projectile``.

**Parameters:**

+------------+-------------+-------------------+---------------------------------------------+
| **Name**   | **Type**    | **Default Value** | **Description**                             |
+------------+-------------+-------------------+---------------------------------------------+
| projectile | CProjectile |                   | The projectile whose type is being fetched. |
+------------+-------------+-------------------+---------------------------------------------+

**Return Values:**

+----------------------+-----------------+
| **Type**             | **Description** |
+----------------------+-----------------+
| EEex_Projectile_Type | See summary.    |
+----------------------+-----------------+

==========================================================================================================================================================================================================

**EEex_Projectile_Type**
************************
+-------------------------+-------------+
| Name                    | Description |
+-------------------------+-------------+
| Unknown                 |             |
+-------------------------+-------------+
| CProjectile             |             |
+-------------------------+-------------+
| CProjectileAmbiant      |             |
+-------------------------+-------------+
| CProjectileArea         |             |
+-------------------------+-------------+
| CProjectileBAM          |             |
+-------------------------+-------------+
| CProjectileChain        |             |
+-------------------------+-------------+
| CProjectileColorSpray   |             |
+-------------------------+-------------+
| CProjectileConeOfCold   |             |
+-------------------------+-------------+
| CProjectileFall         |             |
+-------------------------+-------------+
| CProjectileFireHands    |             |
+-------------------------+-------------+
| CProjectileInstant      |             |
+-------------------------+-------------+
| CProjectileMulti        |             |
+-------------------------+-------------+
| CProjectileMushroom     |             |
+-------------------------+-------------+
| CProjectileNewScorcher  |             |
+-------------------------+-------------+
| CProjectileScorcher     |             |
+-------------------------+-------------+
| CProjectileSegment      |             |
+-------------------------+-------------+
| CProjectileSkyStrike    |             |
+-------------------------+-------------+
| CProjectileSkyStrikeBAM |             |
+-------------------------+-------------+
| CProjectileSpellHit     |             |
+-------------------------+-------------+
| CProjectileTravelDoor   |             |
+-------------------------+-------------+

==========================================================================================================================================================================================================

.. _EEex_Projectile_IsOfType:

:underline:`EEex_Projectile_IsOfType`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Instance Name:** ``isOfType``

.. note::
   **Summary:** Returns ``true`` if ``projectile`` has the type ``checkType`` or is a derivative thereof.
   
   This is useful to ensure that a projectile is of a certain type before accessing members
   it may or may not have.

**Parameters:**

+------------+----------------------+-------------------+---------------------------------------------+
| **Name**   | **Type**             | **Default Value** | **Description**                             |
+------------+----------------------+-------------------+---------------------------------------------+
| projectile | CProjectile          |                   | The projectile whose type is being checked. |
+------------+----------------------+-------------------+---------------------------------------------+
| checkType  | EEex_Projectile_Type |                   | The type to check against.                  |
+------------+----------------------+-------------------+---------------------------------------------+

**Return Values:**

+----------+-----------------+
| **Type** | **Description** |
+----------+-----------------+
| boolean  | See summary.    |
+----------+-----------------+


==========================================================================================================================================================================================================

.. _EEex_Projectile_RegisterGlobalMutator:

:underline:`EEex_Projectile_RegisterGlobalMutator`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. note::
   **Summary:** Registers a global Lua table as a global (always processed) projectile mutator.

**Parameters:**

+------------------+----------+-------------------+------------------------------------+
| **Name**         | **Type** | **Default Value** | **Description**                    |
+------------------+----------+-------------------+------------------------------------+
| mutatorTableName | string   |                   | The name of the table to register. |
+------------------+----------+-------------------+------------------------------------+

==========================================================================================================================================================================================================

**The Mutator Table**
*********************

A mutator table can contain three optional keys, each of which should be assigned a respective mutator function.

The valid function keys are: ``typeMutator``, ``projectileMutator``, and ``effectMutator``:

==========================================================================================================================================================================================================

**typeMutator**
"""""""""""""""

**Parameters:**

+---------+-------+---------------------------------------------+
| Name    | Type  | Description                                 |
+---------+-------+---------------------------------------------+
| context | table | A table containing the context of the hook. |
+---------+-------+---------------------------------------------+

``context`` **keys:**

+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Context Key       | Value Type                   | Description                                                                                                                                      |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| decodeSource      | EEex_Projectile_DecodeSource | The source of the hook, such as ``EEex_Projectile_DecodeSource.CGameSprite_Spell``                           :raw-html:`<br/>`                   |
|                   |                              | for the ``Spell()`` action, ``EEex_Projectile_DecodeSource.CGameSprite_SpellPoint``                          :raw-html:`<br/>`                   |
|                   |                              | for the ``SpellPoint()`` action, etc.                                                                                                            |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingEffect | CGameEffect | nil            | The op408 (ProjectileMutator) effect that registered the containing mutator table.                           :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | This is always ``nil`` for global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``.                                     |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingSprite | CGameSprite | nil            | The sprite that is decoding (creating) the projectile.                                                       :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | Global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``                             :raw-html:`<br/>`                   |
|                   |                              | also run for non-sprite decode sources; in these cases this is ``nil``.                                                                          |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| projectileType    | number                       | The projectile type about to be decoded.                                                                     :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | This is equivalent to the value at ``.SPL->Ability Header->[+0x26]``.                                        :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | Subtract one from this value to get the corresponding ``PROJECTL.IDS`` index.                                                                    |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

**Return Values:**

+--------------+-------------------------------------------------------------------------------------------------------------------+
| Type         | Description                                                                                                       |
+--------------+-------------------------------------------------------------------------------------------------------------------+
| number | nil | The new projectile type, or ``nil`` if the type should not be overridden.     :raw-html:`<br/>` :raw-html:`<br/>` |
|              |                                                                                                                   |
|              | This is equivalent to the value at ``.SPL->Ability Header->[+0x26]``.         :raw-html:`<br/>` :raw-html:`<br/>` |
|              |                                                                                                                   |
|              | Subtract one from this value to get the corresponding ``PROJECTL.IDS`` index.                                     |
+--------------+-------------------------------------------------------------------------------------------------------------------+

==========================================================================================================================================================================================================

**projectileMutator**
"""""""""""""""""""""

**Parameters:**

+---------+-------+---------------------------------------------+
| Name    | Type  | Description                                 |
+---------+-------+---------------------------------------------+
| context | table | A table containing the context of the hook. |
+---------+-------+---------------------------------------------+

``context`` **keys:**

+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Context Key       | Value Type                   | Description                                                                                                                                      |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| decodeSource      | EEex_Projectile_DecodeSource | The source of the hook, such as ``EEex_Projectile_DecodeSource.CGameSprite_Spell``                           :raw-html:`<br/>`                   |
|                   |                              | for the ``Spell()`` action, ``EEex_Projectile_DecodeSource.CGameSprite_SpellPoint``                          :raw-html:`<br/>`                   |
|                   |                              | for the ``SpellPoint()`` action, etc.                                                                                                            |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingEffect | CGameEffect | nil            | The op408 (ProjectileMutator) effect that registered the containing mutator table.                           :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | This is always ``nil`` for global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``.                                     |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingSprite | CGameSprite | nil            | The sprite that is decoding (creating) the projectile.                                                       :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                              |                                                                                                                                                  |
|                   |                              | Global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``                             :raw-html:`<br/>`                   |
|                   |                              | also run for non-sprite decode sources; in these cases this is ``nil``.                                                                          |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| projectile        | CProjectile                  | The projectile about to be returned from the decoding process.                                                                                   |
+-------------------+------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

==========================================================================================================================================================================================================

**effectMutator**
"""""""""""""""""

**Parameters:**

+---------+-------+---------------------------------------------+
| Name    | Type  | Description                                 |
+---------+-------+---------------------------------------------+
| context | table | A table containing the context of the hook. |
+---------+-------+---------------------------------------------+

``context`` **keys:**

+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Context Key       | Value Type                      | Description                                                                                                                                      |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| addEffectSource   | EEex_Projectile_AddEffectSource | The source of the hook, such as ``EEex_Projectile_AddEffectSource.CGameSprite_Spell``                           :raw-html:`<br/>`                |
|                   |                                 | for the ``Spell()`` action, ``EEex_Projectile_AddEffectSource.CGameSprite_SpellPoint``                          :raw-html:`<br/>`                |
|                   |                                 | for the ``SpellPoint()`` action, etc.                                                                                                            |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| effect            | CGameEffect                     | The effect that is being added to ``projectile``.                                                                                                |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingEffect | CGameEffect | nil               | The op408 (ProjectileMutator) effect that registered the containing mutator table.                           :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                                 |                                                                                                                                                  |
|                   |                                 | This is always ``nil`` for global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``.                                     |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| originatingSprite | CGameSprite | nil               | The sprite that decoded (created) the projectile.                                                            :raw-html:`<br/>` :raw-html:`<br/>` |
|                   |                                 |                                                                                                                                                  |
|                   |                                 | Global mutator tables registered via ``EEex_Projectile_RegisterGlobalMutator()``                             :raw-html:`<br/>`                   |
|                   |                                 | also run for non-sprite sources; in these cases this is ``nil``.                                                                                 |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| projectile        | CProjectile                     | The projectile that ``effect`` is being added to.                                                                                                |
+-------------------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

==========================================================================================================================================================================================================

**EEex_Projectile_DecodeSource**
""""""""""""""""""""""""""""""""
+-------------------------------------------------+-------------+
| Name                                            | Description |
+-------------------------------------------------+-------------+
| CBounceList_Add                                 |             |
+-------------------------------------------------+-------------+
| CGameAIBase_FireItem                            |             |
+-------------------------------------------------+-------------+
| CGameAIBase_FireItemPoint                       |             |
+-------------------------------------------------+-------------+
| CGameAIBase_FireSpell                           |             |
+-------------------------------------------------+-------------+
| CGameAIBase_FireSpellPoint                      |             |
+-------------------------------------------------+-------------+
| CGameAIBase_ForceSpell                          |             |
+-------------------------------------------------+-------------+
| CGameAIBase_ForceSpellPoint                     |             |
+-------------------------------------------------+-------------+
| CGameEffect_FireSpell                           |             |
+-------------------------------------------------+-------------+
| CGameEffectCastingGlow_ApplyEffect              |             |
+-------------------------------------------------+-------------+
| CGameEffectChangeStatic_ApplyEffect             |             |
+-------------------------------------------------+-------------+
| CGameEffectSummon_ApplyVisualEffect             |             |
+-------------------------------------------------+-------------+
| CGameEffectVisualSpellHitIWD_ApplyEffect        |             |
+-------------------------------------------------+-------------+
| CGameSprite_Spell                               |             |
+-------------------------------------------------+-------------+
| CGameSprite_SpellPoint                          |             |
+-------------------------------------------------+-------------+
| CGameSprite_Swing                               |             |
+-------------------------------------------------+-------------+
| CGameSprite_UpdateAOE                           |             |
+-------------------------------------------------+-------------+
| CGameSprite_UseItem                             |             |
+-------------------------------------------------+-------------+
| CGameSprite_UseItemPoint                        |             |
+-------------------------------------------------+-------------+
| CMessageFireProjectile_Run                      |             |
+-------------------------------------------------+-------------+
| CProjectile_DecodeProjectile_MultiMagicMissile  |             |
+-------------------------------------------------+-------------+
| CProjectile_DecodeProjectile_ChainCallLightning |             |
+-------------------------------------------------+-------------+
| CProjectile_DecodeProjectile_MultiProjectile    |             |
+-------------------------------------------------+-------------+
| CProjectileArea_CreateSecondary                 |             |
+-------------------------------------------------+-------------+
| CProjectileArea_Explode                         |             |
+-------------------------------------------------+-------------+
| CProjectileChain_AIUpdate                       |             |
+-------------------------------------------------+-------------+
| CProjectileChain_Fire                           |             |
+-------------------------------------------------+-------------+
| CProjectileFall_AIUpdate                        |             |
+-------------------------------------------------+-------------+

**EEex_Projectile_AddEffectSource**
"""""""""""""""""""""""""""""""""""
+-----------------------------+-------------+
| Name                        | Description |
+-----------------------------+-------------+
| CBounceList_Add             |             |
+-----------------------------+-------------+
| CGameAIBase_FireItem        |             |
+-----------------------------+-------------+
| CGameAIBase_FireItemPoint   |             |
+-----------------------------+-------------+
| CGameAIBase_FireSpell       |             |
+-----------------------------+-------------+
| CGameAIBase_FireSpellPoint  |             |
+-----------------------------+-------------+
| CGameAIBase_ForceSpell      |             |
+-----------------------------+-------------+
| CGameAIBase_ForceSpellPoint |             |
+-----------------------------+-------------+
| CGameEffect_FireSpell       |             |
+-----------------------------+-------------+
| CGameSprite_LoadProjectile  |             |
+-----------------------------+-------------+
| CGameSprite_Spell           |             |
+-----------------------------+-------------+
| CGameSprite_SpellPoint      |             |
+-----------------------------+-------------+
| CGameSprite_Swing           |             |
+-----------------------------+-------------+
| CGameSprite_UseItem         |             |
+-----------------------------+-------------+
| CGameSprite_UseItemPoint    |             |
+-----------------------------+-------------+

